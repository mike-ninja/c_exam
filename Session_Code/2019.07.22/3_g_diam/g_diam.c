// Diagrammed on whiteboard; for code see g_diam_correct.c